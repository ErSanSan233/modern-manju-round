# 变形规则表

以下依次列出字形变形的规则和思路。注意，变形规则是依次执行的。也就是说，靠上的规则的输出会作为靠下的规则的输入。

*斜体*表示这是历史残余特性，理论上即使删除也不影响变形处理，但我还没有一一试验，也就暂时没有删除。

## 基本变形

该部分的变形不受前后字母的牵涉，只需要根据字母的位置变形。

### 独立变体（'isol' Isolated Forms）

条件：单独出现

| 字母                    | 变形前 | 变形后 |
| ----------------------- | ------ | ------ |
| `a / e / i / o / u / v` | `dflt` | `isol` |

### 词头变体（'init' Initial Forms）

条件：位于词首

| 字母                                                         | 变形前   | 变形后  |
| :----------------------------------------------------------- | -------- | ------- |
| `a / b / c / d / e / f / g / g.prime / h / h.prime / i / j / k / k.prime / l / m / n / o / p / q / r / r.prime / s / t / u / v / w / x / y / z` | `dflt`   | `init`  |
| *d / t*                                                      | *F.dflt* | *repl1* |
| *f*                                                          | *repl1*  | *repl2* |

### 词尾变体（'fina' Termianl Forms）

条件：位于词尾

| 字母                                         | 变形前     | 变形后     |
| -------------------------------------------- | ---------- | ---------- |
| `a/b/e/i/k/l/m/n/ng/o/r/s/t/w/v/y/y/y.prime` | `dflt`     | `fina`     |
| *e*                                          | *bis.dflt* | *bis.fina* |
| *e*                                          | *F.dflt*   | *F.fina*   |
| *i*                                          | *repl1*    | *i.fina*   |
| *k*                                          | *F.dflt*   | *F.fina*   |
| *k*                                          | *repl1*    | *F.fina*   |
| *k*                                          | *repl2*    | *fina*     |
| *n*                                          | *repl1*    | *fina*     |
| *t*                                          | *repl2*    | *fina*     |
| *u*                                          | *bis.dflt* | *bis.fina* |

## 上下文变形

该部分字母的变形受前后字符的影响。括号中为Lookup表的标题。

### 特殊情况较少的变形（'calt' General Contextual Alternates）

#### f写作w的形态（f before i-o-u-v）

条件：后一个字符属于 i / o / u / u.bis / v行

| 字母 | 变形前 | 变形后 |
| ---- | ------ | ------ |
| f    | dflt   | repl1  |
| f    | init   | repl2  |

#### 作为助词的小-i（little i）

条件：前一个字符为零宽空格

| 字母 | 变形前 | 变形后 |
| ---- | ------ | ------ |
| i    | init   | fina   |
| i    | isol   | fina   |
| i    | dflt   | fina   |

#### 辅音字母与i相连时i双写长牙、辅音字母与u相连时u不写点（i-u after vowel）

条件：前一个字符属于 a/e/e.bis/i/o/u/u.bis/v 行

| 字母 | 变形前   | 变形后       |
| ---- | -------- | ------------ |
| i    | dflt     | repl1        |
| u    | dflt     | bis.dflt     |
| u    | fina     | bis.fina     |
| *u*  | *F.fina* | *bis.F.fina* |
| u    | repl1    | bis.repl1    |

#### t、d的出头形态（t-d at syllable.init）

条件：后一个字符属于 e/u 行

| 字母 | 变形前 | 变形后 |
| ---- | ------ | ------ |
| t/d  | dflt   | F.dflt |
| t/d  | init   | repl1  |

#### e、u因前接带有带圈点的辅音字母而不写点（e-u after t-d-k-g-h）

条件：前一个字符属于 k/g/h/t/d/k.prime/g.prime/h.prime 行

| 字母 | 变形前 | 变形后     |
| ---- | ------ | ---------- |
| e/u  | dflt   | bis.dflt   |
| e/u  | fina   | bis.fina   |
| e/u  | F.dflt | bis.dflt   |
| e/u  | F.fina | bis.F.fina |
| u    | repl1  | bis.repl1  |

#### k、n、t位于音节末的替换型（t-k-n at syllable.fina）

此处默认k统一替换为两牙两点的非“阴性”形态，将“阴性”情况留到后面处理。

条件：后一个字符为辅音字母，且属于dflt/F.dflt/repl1列

| 字母 | 变形前 | 变形后 |
| ---- | ------ | ------ |
| k/t  | dflt   | repl2  |
| n    | dflt   | repl1  |

### 音节末的“阴性”k形态（k.F at syllable.fina）

条件：以下三组条件中满足一组即可

| 字母 | 变形前  | 变形后   |
| ---- | ------- | -------- |
| `k`  | `fina`  | `F.fina` |
| `k`  | `repl2` | `F.dflt` |

#### -ek和-vk中的k变为“阴性”（e-vk）

- 前一个字符为以下字符之一
  - `e.dflt/e.init/e.F.dflt/`
  - `e.bis.dflt`
  - `v.dlft/v.init`

#### kuk、guk、huk中的k变为“阴性”（g-k-h-uk）

同时满足：

- 前第二个字符为以下字符之一：
  - `k.dflt/k.init/k.F.dflt/k.repl1` 
  - `g.dflt/g.init/g.F.dflt/g.repl1` 
  - `h.dflt/h.init/h.F.dflt/h.repl1`
- 前一个字符为 `u.bis.dflt`

#### k'ak、g'ak、h'ak的k变为“阴性”（g'-k'-h'-ak）

同时满足：

- 前第二个字符为以下字符：：

  - `k.prime.dflt/k.prime.init/k.prime.F.dflt/k.prime.repl1`

  - `g.prime.dflt/g.prime.init/g.prime.F.dflt/g.prime.repl1`

  - `h.prime.dflt/h.prime.init/h.prime.F.dflt/h.prime.repl1`

- 前一个字符为 `a.dflt`

### tek中的k不用“阴性”（tek.F back to k）

条件（同时满足）：

- 前第二个字符属于 `t` 行
- 前一个字符为 `e.dflt` 或 `e.bis.dflt`

| 字母 | 变形前   | 变形后  |
| ---- | -------- | ------- |
| `k`  | `F.fina` | `fina`  |
| `k`  | `F.dflt` | `repl2` |

### 圆字母的变形（Round Syllables）

#### g、h、k的“阴性”半宽（half width - kgh）

条件：后一个字符属于 u / u.bis 行

| 字母      | 变形前 | 变形后 |
| --------- | ------ | ------ |
| g / h / k | dflt   | repl1  |
| g / h / k | init   | repl1  |

#### g、h、k强制转“阴性”半宽（kgh special F half width）

用于在一些特殊拼写（如nehv）中，通过FSV1强制显示g、h、k的“阴性”字形，且根据后面搭配的字母自动转换为半宽字形。

条件（同时满足）：

- 后一个字符为FVS1
- 后第二个字符属于o/v行

| 字母      | 变形前 | 变形后 |
| --------- | ------ | ------ |
| g / h / k | dflt   | repl1  |
| g / h / k | init   | repl1  |

#### g、h、k强制转“阴性”全宽（kgh special F form dflt）

用于在一些特殊拼写（如nehv）中，通过FSV1强制显示g、h、k的“阴性”字形，且不再自动转换为半宽字形。

条件：后一个字符为FVS1

| 字母      | 变形前 | 变形后 |
| --------- | ------ | ------ |
| g / h / k | dflt   | F.dflt |
| g / h / k | init   | F.dflt |
| k         | fina   | F.fina |
| k         | repl2  | F.dflt |

#### g'v、h'v、k'v音节中的g'、h'、k'展示为不带撇的形式



#### b、p显示为半宽



#### g'、h'、k'显示为半宽



